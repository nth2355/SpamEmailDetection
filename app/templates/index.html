<!DOCTYPE html>
<html>
<head>
    <title>Ph√°t Hi·ªán Th∆∞ R√°c NLP</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='malware.png') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        body { background-color: #f8f9fa; }
        .container { max-width: 800px; margin-top: 50px; }
        .alert-custom { font-size: 1.5rem; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4 text-primary">ü§ñ Ph√°t Hi·ªán Th∆∞ R√°c T·ª± ƒê·ªông</h1>
        
        <form id="predictionForm" action="{{ url_for('predict') }}" method="POST" class="p-4 border rounded shadow-lg bg-white">
            <div class="mb-3">
                <label for="message_text" class="form-label fw-bold">Nh·∫≠p n·ªôi dung tin nh·∫Øn/email c·∫ßn ki·ªÉm tra:</label>
                <textarea class="form-control" id="message_text" name="message_text" rows="6" required>{{ input_text | default('', true) }}</textarea>
            </div>
            
            <button type="submit" id="submitButton" class="btn btn-success w-100 py-2">
                <span id="spinner" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true" style="display:none;"></span>
                <span id="buttonText">KI·ªÇM TRA SPAM</span>
            </button>
        </form>

        {% if final_label %}
            <div class="mt-4 p-4 rounded shadow-lg bg-light">
                <h2 class="text-center mb-3">K·∫øt Qu·∫£ Ph√¢n T√≠ch</h2>
                
                <div class="alert alert-custom text-center mb-4 
                    {% if 'SPAM' in final_label %} alert-danger 
                    {% else %} alert-success {% endif %}">
                    <strong>Ph√¢n Lo·∫°i: {{ final_label }}</strong>
                </div>

                <h4 class="mt-4 text-center">X√°c su·∫•t chi ti·∫øt:</h4>
                
                <div class="mb-4">
                    <div class="d-flex justify-content-between">
                        <small>HAM (Th∆∞ h·ª£p l·ªá):</small>
                        <strong>{{ prob_ham }}</strong>
                    </div>
                    {% set ham_width = prob_ham | replace('%', '') %}
                    <div class="progress" style="height: 25px;">
                        <div class="progress-bar bg-success" role="progressbar" 
                             style="width: {{ ham_width }}%" aria-valuenow="{{ ham_width }}" 
                             aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <small>SPAM (Th∆∞ r√°c):</small>
                        <strong>{{ prob_spam }}</strong>
                    </div>
                    {% set spam_width = prob_spam | replace('%', '') %}
                    <div class="progress" style="height: 25px;">
                        <div class="progress-bar bg-danger" role="progressbar" 
                             style="width: {{ spam_width }}%" aria-valuenow="{{ spam_width }}" 
                             aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', function(event) {
            const submitButton = document.getElementById('submitButton');
            document.getElementById('spinner').style.display = 'inline-block';
            document.getElementById('buttonText').textContent = 'ƒêang Ph√¢n T√≠ch...';
            
            submitButton.disabled = true;
            
        });
    </script>
</body>
</html>